# SpreadsheetAnalyzer 用户手册

## 目录

1. [软件简介](#软件简介)
2. [快速开始](#快速开始)
3. [功能说明](#功能说明)
4. [详细使用教程](#详细使用教程)
5. [常见问题](#常见问题)
6. [快捷键参考](#快捷键参考)

---

## 软件简介

**SpreadsheetAnalyzer** 是一款基于 Qt6 的现代化电子表格数据分析与可视化工具，专为非专业用户设计，提供专业级的数据分析能力。

### 主要特点

- 🎯 **易用性强**：直观的图形界面，无需编程知识
- 📊 **功能丰富**：支持描述性统计、预测分析、矩阵运算
- 📈 **可视化强大**：提供 6+ 种图表类型，支持导出为图片
- 📁 **多格式支持**：CSV、TXT、Excel 文件的导入导出
- 🚀 **性能优秀**：支持万行级数据的流畅操作

### 适用场景

- 科研数据处理与分析
- 商业数据报表制作
- 学生数据统计作业
- 个人财务数据分析
- 问卷调查结果统计

---

## 快速开始

### 系统要求

| 组件 | 要求 |
|------|------|
| 操作系统 | Windows 10/11, macOS 10.15+, Linux (Ubuntu 20.04+) |
| 内存 | 最低 2GB，推荐 4GB |
| 硬盘 | 100MB 可用空间 |
| 显示器 | 1024×768 分辨率 |

### 安装步骤

#### Windows

1. 下载最新版本：[GitHub Releases](https://github.com/csai-H/SpreadsheetAnalyzer/releases)
2. 解压缩到任意目录
3. 双击 `SpreadsheetAnalyzer.exe` 启动

#### 从源码编译

详见 [COMPILE_GUIDE.md](COMPILE_GUIDE.md)

### 首次运行

启动后会看到主界面：

```
┌─────────────────────────────────────────────────┐
│ 文件 编辑 视图 帮助                           │
├─────────────────────────────────────────────────┤
│ [打开] [保存] [导出]                           │
├───────┬──────────────────────────────────────────┤
│打开的│  数据 | 图表                            │
│文件   │                                         │
│       │  ┌──────────────────────────────────┐   │
│       │  │  姓名    年龄    工资           │   │
│       │  │  张三    25      5000          │   │
│       │  │  李四    30      6000          │   │
│       │  └──────────────────────────────────┘   │
├───────┴──────────────────────────────────────────┤
│ 就绪                              [统计信息]   │
│ [文件名.csv]   [1234 行 × 5 列]               │
└─────────────────────────────────────────────────┘
```

---

## 功能说明

### 1. 数据导入

#### 支持 CSV 文件

**操作步骤：**
1. 点击菜单 `文件` → `打开`
2. 选择 CSV 文件（`.csv`）
3. 系统自动识别表头和数据

**CSV 格式要求：**
- 第一行为表头（列名）
- 使用逗号、分号或制表符分隔
- 支持 UTF-8 编码

#### 支持 Excel 文件

**操作步骤：**
1. 点击菜单 `文件` → `打开`
2. 选择 Excel 文件（`.xlsx`, `.xls`）
3. 选择工作表（如有多表）

**注意：**
- 目前只支持数据读取
- 复杂格式（合并单元格、公式）可能无法正确显示

#### 拖放导入

直接将文件拖放到窗口中即可打开。

### 2. 数据查看

#### 基本操作

| 操作 | 方法 |
|------|------|
| 查看数据 | 表格自动显示全部数据 |
| 滚动 | 使用鼠标滚轮或滚动条 |
| 选择单元格 | 点击单个单元格 |
| 选择范围 | 拖动鼠标或 Shift+点击 |
| 选择整列 | 点击列标题 |
| 选择整行 | 点击行标题 |

#### 快速统计

选中单元格后，状态栏实时显示：
- 选中单元格数量
- 求和（Σ）
- 均值
- 最小值
- 最大值

**示例：**
```
选中: 10 格 | Σ: 15.5K | 均值: 1550 | 最小: 100 | 最大: 5000
```

### 3. 数据排序

#### 单列排序

**操作：**
1. 点击列标题（表头）
2. 再次点击切换升序/降序

**特点：**
- 自动识别数值列，按数值排序
- 文本列按字母顺序排序

### 4. 数据过滤

#### 启用过滤对话框

**菜单：** `数据` → `过滤数据`

**功能：**
- 选择要过滤的列
- 设置条件（大于、小于、等于、包含等）
- 输入比较值
- 点击"应用"

**示例：**
```
过滤列：工资
条件：大于等于
值：5000
结果：只显示工资 >= 5000 的行
```

### 5. 统计分析

#### 打开统计对话框

**菜单：** `工具` → `统计分析`

#### 描述性统计

**可计算的统计量：**
- 计数（Count）
- 求和（Sum）
- 均值（Mean）
- 中位数（Median）
- 众数（Mode）
- 方差（Variance）
- 标准差（Std Dev）
- 最小值（Min）
- 最大值（Max）
- 极差（Range）
- 偏度（Skewness）
- 峰度（Kurtosis）
- 四分位数（Q1, Q2, Q3）

#### 预测分析

**支持的预测方法：**
- 移动平均（Moving Average）
- 指数平滑（Exponential Smoothing）
- 线性回归（Linear Regression）

#### 矩阵运算

**支持的操作：**
- 矩阵加法
- 矩阵减法
- 矩阵乘法
- 矩阵转置
- 行列式计算
- 矩阵求逆

### 6. 数据可视化

#### 创建图表

**方法 1：侧边栏快速选择**
1. 点击侧边栏的图表类型
2. 在"图表数据列"中选择要可视化的列
3. 自动生成图表

**方法 2：图表标签页**
1. 切换到"图表"标签页
2. 选择图表类型
3. 点击"刷新"

#### 支持的图表类型

| 图表类型 | 适用场景 | 示例 |
|----------|----------|------|
| **柱状图** | 分类对比 | 各部门销售额对比 |
| **折线图** | 趋势展示 | 每月销售额变化 |
| **散点图** | 相关性分析 | 广告费 vs 销售额 |
| **饼图** | 占比分析 | 各产品市场占比 |
| **箱型图** | 分布分析 | 薪资分布统计 |
| **面积图** | 累积趋势 | 累计销售额 |

#### 图表自定义

**在图表标签页的工具栏：**
- 修改图表标题
- 调整图表类型
- 设置导出分辨率
- 导出为图片

**导出格式：**
- PNG（无损，推荐）
- JPEG（体积小）
- PDF（适合打印）

### 7. 数据导出

#### 导出为 CSV

**菜单：** `文件` → `保存` 或 `另存为`

#### 导出为 Excel

**菜单：** `文件` → `导出为Excel`

#### 导出图表

**菜单：** 图表标签页 → `导出图片`

---

## 详细使用教程

### 教程 1：分析销售数据

**目标：** 分析某公司一年来的销售数据

**步骤：**

1. **导入数据**
   - 打开 `sales_data.csv`
   - 数据格式：`月份,销售额,成本,利润`

2. **查看快速统计**
   - 选择"销售额"整列
   - 状态栏显示：`选中: 12 格 | Σ: 120万 | 均值: 10万 | 最小: 5万 | 最大: 15万`

3. **创建趋势图**
   - 侧边栏选择"折线图"
   - 选择"销售额"列
   - 自动生成折线图

4. **导出报告**
   - 点击"导出图片"
   - 选择 PNG 格式
   - 保存为 `sales_trend.png`

### 教程 2：学生成绩分析

**目标：** 分析班级考试成绩

**步骤：**

1. **导入数据**
   - 打开 `grades.csv`
   - 列：姓名,语文,数学,英语,总分

2. **描述性统计**
   - 菜单：`工具` → `统计分析`
   - 选择"数学"列
   - 查看统计结果

3. **成绩分布图**
   - 创建"柱状图"
   - 选择"总分"列
   - 调整图表标题

4. **筛选高分学生**
   - 菜单：`数据` → `过滤数据`
   - 条件：总分 ≥ 450

---

## 常见问题

### Q1: 为什么打开的中文是乱码？

**A:** 可能是编码问题。尝试：
1. 用记事本打开 CSV，另存为 UTF-8 编码
2. 在 Excel 中另存为"CSV UTF-8"

### Q2: 支持哪些 Excel 版本？

**A:**
- ✅ 支持：`.xlsx` (Excel 2007+)
- ✅ 支持：`.xls` (Excel 97-2003)
- ⚠️ 限制：只读取数据，不支持公式、图表等复杂功能

### Q3: 大文件打开很慢怎么办？

**A:**
- 目前建议文件大小不超过 50MB
- 行数不超过 100,000 行
- 未来版本会优化大文件性能

### Q4: 如何撤销操作？

**A:** 目前撤销功能正在开发中，建议：
- 导出数据前先保存原文件
- 使用"另存为"保存副本

### Q5: 图表可以保存为矢量图吗？

**A:**
- ✅ PNG、JPEG：支持
- ✅ PDF：支持（矢量，可缩放）
- ❌ SVG：暂不支持（自动转为高清 PNG）

### Q6: 可以同时打开多个文件吗？

**A:** 可以！
- 侧边栏显示所有打开的文件
- 点击切换不同文件
- 右键可以关闭文件

---

## 快捷键参考

### 文件操作

| 快捷键 | 功能 |
|--------|------|
| `Ctrl+O` | 打开文件 |
| `Ctrl+S` | 保存文件 |
| `Ctrl+Shift+S` | 另存为 |
| `Ctrl+W` | 关闭文件 |
| `Ctrl+Q` | 退出程序 |

### 编辑操作

| 快捷键 | 功能 | 状态 |
|--------|------|------|
| `Ctrl+C` | 复制 | 🚧 开发中 |
| `Ctrl+V` | 粘贴 | 🚧 开发中 |
| `Ctrl+A` | 全选 | 🚧 开发中 |
| `Ctrl+Z` | 撤销 | 🚧 开发中 |
| `Ctrl+Y` | 重做 | 🚧 开发中 |

### 视图操作

| 快捷键 | 功能 |
|--------|------|
| `Ctrl++` | 放大 | 🚧 开发中 |
| `Ctrl+-` | 缩小 | 🚧 开发中 |
| `Ctrl+0` | 重置缩放 | 🚧 开发中 |

### 其他

| 快捷键 | 功能 |
|--------|------|
| `F5` | 刷新图表 |
| `Ctrl+F` | 查找 | 🚧 开发中 |
| `Delete` | 删除选中行 |

---

## 技术支持

### 获取帮助

- 📖 [GitHub Issues](https://github.com/csai-H/SpreadsheetAnalyzer/issues)
- 📧 Email: csai-H@users.noreply.github.com
- 📝 [用户反馈](https://github.com/csai-H/SpreadsheetAnalyzer/issues/new)

### 报告 Bug

提交 Issue 时请包含：
1. 操作系统版本
2. 文件类型和大小
3. 详细的问题描述
4. 错误截图（如有）

---

## 版本信息

- **当前版本**：v1.0.0
- **发布日期**：2026年1月
- **Qt 版本**：6.10.1
- **编译器**：MinGW 13.1 / MSVC 2019+

---

*本手册最后更新于 2026年1月23日*
