# SpreadsheetAnalyzer 更新日志

本文档记录 SpreadsheetAnalyzer 的版本历史和更新内容。

## [Unreleased]

### 计划中的功能
- [ ] 复制/粘贴/全选功能
- [ ] 撤销/重做功能
- [ ] 主题切换
- [ ] 数据验证
- [ ] 条件格式化
- [ ] 搜索高亮功能
- [ ] 冻结首行/首列

---

## [v1.0.0] - 2026-01-23

### 新增功能

#### 🎯 核心功能
- ✅ **文件导入**
  - 支持 CSV/TXT 文件导入（自动识别表头）
  - 支持 Excel 文件导入（.xlsx, .xls）
  - 拖放文件直接打开
  - 自动识别编码（UTF-8）

- ✅ **数据展示**
  - 表格视图（支持 100,000+ 行）
  - 自适应列宽（智能算法）
  - 表头排序（点击列标题）
  - 快速统计面板（实时显示求和、均值、最值）

- ✅ **统计分析**
  - 描述性统计（15+ 种统计量）
    - 计数、求和、均值
    - 中位数、众数
    - 方差、标准差
    - 最小值、最大值、极差
    - 偏度、峰度
    - 四分位数（Q1, Q2, Q3）
  - 预测分析
    - 移动平均
    - 指数平滑
    - 线性回归
  - 矩阵运算
    - 加减乘
    - 转置
    - 行列式
    - 求逆

- ✅ **数据可视化**
  - 6+ 种图表类型
    - 柱状图（Bar Chart）
    - 折线图（Line Chart）
    - 散点图（Scatter Plot）
    - 饼图（Pie Chart）
    - 箱型图（Box Plot）
    - 面积图（Area Chart）
  - 图表导出（PNG、JPEG、PDF）
  - 图表自定义（标题、颜色、分辨率）

- ✅ **数据操作**
  - 数据过滤（FilterDialog）
  - 计算列（CalcColumnDialog）
  - 分组汇总（GroupByDialog）

#### 🔧 用户界面
- ✅ **多文档管理**
  - 同时打开多个文件
  - 文档列表侧边栏
  - 快速切换文档
  - 右键关闭文档

- ✅ **最近文件**
  - 记录最近 10 个文件
  - 持久化保存（QSettings）
  - 快速重新打开

- ✅ **状态栏信息**
  - 实时显示行列数
  - 快速统计面板
  - 文件信息显示
  - 加载进度条

- ✅ **颜色主题**
  - 默认主题
  - 深色主题
  - 现代主题

### 改进优化

#### 性能优化
- ✅ 智能列宽自适应（采样 100 行）
- ✅ 大数字格式化（K/M 表示）
- ✅ 图表渲染优化

#### 用户体验
- ✅ 表头显示真实列名（不再是 1、2、3）
- ✅ 箱型图添加坐标轴
- ✅ 右键菜单（列宽调整、关闭文档等）
- ✅ 工具提示

#### 代码质量
- ✅ 模块化架构（MVC 模式）
- ✅ PIMPL 模式（TableData）
- ✅ 智能指针（QSharedPointer）
- ✅ 信号槽机制

### 技术栈

| 技术 | 版本 | 说明 |
|------|------|------|
| Qt | 6.10.1 | GUI 框架 |
| Qt Charts | 6.10.1 | 图表库 |
| C++ | 17 | 编程语言 |
| CMake | 4.0.0-rc4 | 构建工具 |
| OpenXLSX | master | Excel 处理 |
| MinGW | 13.1.0 | Windows 编译器 |

### 文件统计

```
总计: 30+ 个源文件
代码量: 11,000+ 行 C++ 代码
模块数: 10+ 个主要模块
```

### 已知问题

- [ ] 复制/粘贴功能未实现
- [ ] 撤销/重做未连接
- [ ] 单元格编辑功能缺失
- [ ] 大文件（>100MB）加载慢
- [ ] 没有单元测试
- [ ] 文档不够详细

### 下载

- **Windows**: [SpreadsheetAnalyzer-v1.0.0-Windows.zip](https://github.com/csai-H/SpreadsheetAnalyzer/releases/download/v1.0.0/SpreadsheetAnalyzer-v1.0.0-Windows.zip)
- **源代码**: [v1.0.0.tar.gz](https://github.com/csai-H/SpreadsheetAnalyzer/archive/refs/tags/v1.0.0.tar.gz)

### 安装

#### Windows

1. 下载并解压缩
2. 双击 `SpreadsheetAnalyzer.exe`
3. 或从命令行运行

#### 从源码编译

详见 [DEVELOPER_GUIDE.md](DEVELOPER_GUIDE.md)

### 迁移指南

从 v0.x 升级到 v1.0.0：

- ⚠️ **配置文件不兼容**：需要重新设置
- ✅ **数据文件兼容**：CSV/Excel 文件可直接打开
- ✅ **设置保留**：最近文件列表会保留

### 贡献者

- [@csai-H](https://github.com/csai-H) - 主要开发者

### 许可证

MIT License - 详见 [LICENSE](LICENSE)

---

## 版本命名规则

- **主版本号**：重大架构变更或不兼容更新
- **次版本号**：新功能添加
- **修订号**：Bug 修复和小改进

示例：`v1.2.3`
- 主版本：1
- 次版本：2
- 修订号：3

---

## 未来计划

### v1.1.0（计划中）

- [ ] 实现复制/粘贴/全选
- [ ] 搜索高亮功能
- [ ] 冻结首行/首列
- [ ] 数据验证
- [ ] 性能优化（虚拟化表格）

### v1.2.0（计划中）

- [ ] 条件格式化
- [ ] 单元格编辑
- [ ] 公式支持
- [ ] 数据透视表
- [ ] 多级排序

### v2.0.0（远期规划）

- [ ] 跨平台支持（macOS, Linux）
- [ ] 插件系统
- [ ] 脚本支持（Python/JavaScript）
- [ ] 云端同步
- [ ] 协作编辑

---

*更新日志最后更新于 2026年1月23日*
